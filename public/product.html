<!doctype html><html><head><meta charset=utf-8><meta name=viewport content=width=device-width,initial-scale=1><title>Product - swag.</title><link rel="stylesheet" href="styles.css"></head><body>
<header class="topbar"><div class="brand"><img src="swaglogo.jpg" class="logo"/><div class="brand-name">swag.</div></div><nav><a href="/">Home</a></nav></header>
<div style="padding:90px 8%"><div id="cont"></div></div>
<script>
function getId(){ const params = new URLSearchParams(location.search); return params.get('id'); }
const id = getId();
if(!id){ document.getElementById('cont').innerText='Product not found'; }
else{
 fetch('/api/products').then(r=>r.json()).then(ps=>{
   const p = ps.find(x=>String(x.id)===String(id));
   if(!p){ document.getElementById('cont').innerText='Product not found'; return; }
   document.title = p.name + ' â€” swag.';
   document.getElementById('cont').innerHTML = `<div style="display:flex;gap:40px;align-items:center;flex-wrap:wrap"><img src="${p.img||'swaglogo.jpg'}" style="width:360px;height:360px;object-fit:contain;border-radius:20px"/><div style="max-width:560px"><h1 style="margin:0">${p.name}</h1><p style="color:rgba(0,0,0,0.6)">${p.description||''}</p><div style="font-weight:900;font-size:28px;margin-top:10px">$${p.price}</div><div style="margin-top:18px"><button style="padding:12px 18px;border-radius:12px;background:#000;color:#fff;border:none" id="buyBtn">Buy</button></div></div></div>`;
   document.getElementById('buyBtn').addEventListener('click', ()=>{
     // attempt Stripe Checkout redirection (server must implement /create-checkout-session)
     fetch('/create-checkout-session', {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({productId:p.id})})
     .then(r=>r.json()).then(d=>{ if(d.url) window.location = d.url; else alert('Checkout not configured on server'); }).catch(()=> alert('Checkout not configured') );
   });
 }).catch(()=>{ const raw = localStorage.getItem('swag_site_data_v2'); if(!raw){ document.getElementById('cont').innerText='Product not found'; return; } const d = JSON.parse(raw); const p = d.products.find(x=>String(x.id)===String(id)); if(!p){ document.getElementById('cont').innerText='Product not found'; return; } document.getElementById('cont').innerHTML = `<div style="display:flex;gap:40px;align-items:center"><img src="${p.img}" style="width:260px;height:260px;object-fit:contain;border-radius:20px"/><div><h1 style="margin:0">${p.name}</h1><p>${p.long||p.short}</p><div style="font-weight:800">${p.price}</div></div></div>`; });
}
</script>
</body></html>
